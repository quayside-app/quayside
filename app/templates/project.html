{% extends '_base.html' %}
{% load static %}

{% block content %}
<script>
/*
* Updates project name.
*/
(async function () {
  try {
    const response = await fetch('{{apiUrl}}/projects?id={{projectID}}')
    if (!response.ok) throw new Error('Network response was not ok')
    const projects = await response.json()
    const project = projects[0]

    const projectNameElement = document.getElementById('projectName')
    projectNameElement.textContent = 'Project: ' + project.name
  } catch (error) {
    console.error('There has been a problem with fetching projects:', error)
  }
})()
</script>
<div class=" text-white">

  <div class="flex justify-between bg-neutral-800 rounded-lg py-2 px-4 m-6">
    <div id="projectName" class="my-auto sm:text-2xl"></div>

    <div class="flex justify-center">
      <a href="create-task/">
        <button id="addTaskButton" class="text-center rounded-lg mx-4 px-2 py-1 bg-neutral-600 hover:bg-gray-500 ">
          <div class="text-2xl font-bold mx-1 ">+</div>
        </button>
      </a>

      <button id="deleteProjectButton" class="text-center rounded-lg  px-2 py-1 bg-neutral-600 hover:bg-red-500">
        {% include "components/svg/delete.svg" %}
      </button>
    </div>

  </div>

  {% block projectContent %}{% endblock %}

</div>
<script>
/*
* Deletes project when button is clicked.
*/
document.getElementById('deleteProjectButton').addEventListener('click', async function () {
  const response = await fetch('{{apiUrl}}/projects/?id={{projectID}}', { method: 'DELETE' })
  if (!response.ok) throw new Error('Network response was not ok')

  // Navigate Home after deleting
  window.location.href = '/'
})
</script>

{% endblock %}