{% extends "project.html" %}
{% load static %}
{% block projectContent %}


{% comment %} <head>
    <!-- TODO use npm nodemanager instead of the headers -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head> {% endcomment %}

<div class = 'text-white h-screen'>

  <div id="featureSection" class='flex justify-center min-h-screen'>

    <div class="flex  mx-4  w-full h-full text-xl">
      
      <div class="w-1/3 m-2 p-2 rounded-xl bg-neutral-800">
        <div class="font-bold text-2xl my-2">Todo</div>
        <div id="todoListDiv">
          <div id="todolist"></div>
        </div>
      </div>

      <div class="w-1/3 m-2 p-2 rounded-xl bg-amber-400">
        <div class="font-bold text-2xl my-2">In-Progress</div>
        <div id="inProgListDiv">
          <div id="inproglist"></div>
        </div>
      </div>  

      <div class="w-1/3 m-2 p-2 rounded-xl bg-teal-700">
        <div class="font-bold text-2xl my-2">Done</div>
        <div id="doneListDiv" >
          <div id="donelist"></div>
        </div>
      </div>

    </div>

  </div>
  
</div> 


<script>
  (async function () {
    try {
      const response = await fetch('{{ apiUrl }}/kanban/?projectID={{projectID}}')
  
      if (!response.ok) throw new Error('Network response was not ok')
      const tasks = await response.json()
      console.log(tasks)
      const todoListElement = document.getElementById('todolist')
      tasks['Todo'].forEach(function (task) {
        const listLink = document.createElement('a')
        //listLink.href = `/project/${project.id}/graph`
        listLink.textContent = task.name
        listLink.className = 'block rounded-lg my-2 p-1 hover:bg-neutral-500 bg-neutral-600 '
        todoListElement.appendChild(listLink)
      })

      const inProgListElement = document.getElementById('inproglist')
      tasks['In-Progress'].forEach(function (task) {
        const listLink = document.createElement('a')
        //listLink.href = `/project/${project.id}/graph`
        listLink.textContent = task.name
        listLink.className = 'block rounded-lg my-2 p-1 hover:bg-neutral-500 bg-neutral-600 '
        inProgListElement.appendChild(listLink)
      })

      const doneListElement = document.getElementById('donelist')
      tasks['Done'].forEach(function (task) {
        const listLink = document.createElement('a')
        //listLink.href = `/project/${project.id}/graph`
        listLink.textContent = task.name
        listLink.className = 'block rounded-lg my-2 p-1 hover:bg-neutral-500 bg-neutral-600 '
        doneListElement.appendChild(listLink)
      })
    } catch (error) {
      console.error('There has been a problem with fetching projects:', error)
    }
  })()
</script>

{% endblock %}